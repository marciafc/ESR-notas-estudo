# REST com Spring

  - 4.1 O que é REST?
  
    - REpresentational State Transfer
	
	- Roy Thomas Fielding
	
    - Modelo arquitetural
	
	- Formaliza um conjunto de constraints (melhores práticas)
	
	- Vantagens
	
	  - Separação entre cliente e servidor
	
	  - Escalabilidade
	  
	  - Independência de linguagem
	  
	  - Mercado
	  
  - 4.2. Conhecendo as constraints do REST	  
  
    - Client-servidor
	
	- Stateless
	
	- Cache
	
	- Interface uniforme
	
	- Sistema em camadas
	
	- Código sob demanda
	
  - 4.3. Diferença entre REST e RESTful
  
    - A diferença é conceitual
  
    - REST: estilo arquitetural que possui as constraints (é a especificação)
	
	- RESTful: ou "RESTful API" é uma API desenvolvida em conformidade com as constraints
	
	  - Verdadeiramente RESTful: 100% em conformidade com as constraints
	  
	  - Às vezes violam alguma constraint
	  
  - 4.4. Desenvolvedores de REST APIs puristas e pragmáticos
  
    - Puristas: REST API deve seguir fielmente os princípios REST, sem exceções
	
	- Pragmáticos: defendem abordagem mais prática, seguem as constraints, mas estão abertos a exceções, se isso tornar o uso da API mais simples
	
  - 4.5. Conhecendo o protocolo HTTP	
  
    - REST é independente de protocolo (é preciso de um)
	
	- Mais comum é o protocolo http
	
	  - requisição -> resposta
	  
	  - Composição da requisição
	  
	    - Métodos, verbos http
	  
	    - URI
	  
	    - Versão
		
		- Cabeçalhos
		
		- Corpo / Payload
		
    - Composição da resposta
	
	  - Versão
	  
	  - Status
	  
	  - Cabeçalhos
	  
	  - Corpo
	  
  - 4.6. Usando o protocolo HTTP	

```  
// Usando Telnet  
$ telnet www.uol.com.br 80

// Colar o texto abaixo e dar dois ENTERs
GET / HTTP/1.1
Host: www.uol.com.br
Accept: text/html

// Resposta
HTTP/1.1 301 Moved Permanently
(...)
Location: https://www.uol.com.br/


// Mudar para porta 443 (https), pois 80 é http (por isso deu 301 e 'Location: httpS://www.uol.com.br/ )
$ telnet www.uol.com.br 443	  
	  
// Colar o texto abaixo e dar dois ENTERs
GET / HTTP/1.1
Host: www.uol.com.br
Accept: text/html	  
	
// Resposta será 400: telnet nao serve -> informação tem que estar criptografada para https	
HTTP/1.1 400 Bad Request

// Instalar GnuTLS
$ sudo apt install gnutls-bin

// Não precisa especificar a porta, já vai usar a 443
gnutls-cli www.uol.com.br

// Colar o texto abaixo e dar dois ENTERs
GET / HTTP/1.1
Host: www.uol.com.br
Accept: text/html	  

```

Usando API do Github

Github API: https://docs.github.com/en/rest/guides/getting-started-with-the-rest-api

```

$ gnutls-cli api.github.com

GET /users/algaworks/repos HTTP/1.1
Host: api.github.com	
Accept: application/json

// HTTP/1.1 403 Forbidden
// Request forbidden by administrative rules. Please make sure your request has a User-Agent header (http://developer.github.com/v3/#user-agent-required).
// Neste caso, obriga passar o User-Agent - passar qlq coisa
$ gnutls-cli api.github.com

GET /users/algaworks/repos HTTP/1.1
Host: api.github.com	
Accept: application/json
User-Agent: ESR

```

  - 4.7. Instalando e testando o Postman

    - [Postman](https://www.getpostman.com/)
	
    - [Insomnia](https://insomnia.rest/)
	
  - 4.8. Entendendo o que são Recursos REST	
  
    - Singleton Resource: recurso único
	
    - Collection Resource: coleção de um dado recurso
	
  - 4.9. Identificando recursos REST

    - URI
	
  - 4.10. [Modelando e requisitando um Collection Resource com GET](https://github.com/marciafc/curso-especialista-spring-rest/tree/master/04.10-modelando-e-requisitando-um-collection-resource-com-get/algafood-api)
  
  - 4.11. [Desafio: collection resource de estados](https://github.com/marciafc/curso-especialista-spring-rest/tree/master/04.11-desafio-collection-resource-de-estados/algafood-api)
  
  - 4.12. Representações de recursos e content negotiation
  
    - Representação de um recurso não é o próprio recurso, o recurso é o objeto. A representação é a transformação desse objeto em um código que seja possível visualizar/ler as informações do recurso
	
    - Media type (context negociation)
      - json
	  - xml
	
  - 4.13. [Implementando content negotiation para retornar JSON ou XML](https://github.com/marciafc/curso-especialista-spring-rest/tree/master/04.13-implementando-content-negotiation-para-retornar-json-ou-xml/algafood-api)
  
    - GET http://localhost:8080/cozinhas
	
	- Headers (cabeçalho)
	
	  - No Spring usar 'produces' para xml ou json se quiser especificar que um determinado método só responde com um ou outro (se não especificar, responderá a ambos)
	    - Ou informar com um um array: produces = {MediaType.APPLICATION_XML_VALUE, MediaType.APPLICATION_JSON_VALUE}) no método que deverá responder nos dois formatos
		- Pode definir 'produces' no escopo da classe: nesse caso é necessário informar 'value' e 'produces'
		
      - Incluir dependência 'jackson-dataformat-xml' para permitir responder em xml
	
	  - Na requisição
	    - Accept: application/xml	      
		
	    - Accept: application/json
	  
  - 4.14. [Consultando Singleton Resource com GET e @PathVariable](https://github.com/marciafc/curso-especialista-spring-rest/tree/master/04.14-consultando-singleton-resource-com-get-e-pathvariable/algafood-api)
  
    - GET http://localhost:8080/cozinhas/1	  
	
	- Editando o [arquivo de hosts](https://king.host/wiki/artigo/como-editar-o-arquivo-hosts-no-linux-ubuntu/) para usar 'api.algafood.local' no host

	```	
	$ sudo nano /etc/hosts
	
	// Incluir a linha
  	127.0.1.1       api.algafood.local
	
  	Ctrl + O e depois Enter
  	Ctrl + X
	```
    - GET api.algafood.local:8080/cozinhas/1
	
	- {cozinhaId} -> placeholder
	
	- @GetMapping("/{cozinhaId}")  -> faz o binding com '@PathVariable' das seguintes formas:
	
	  - @PathVariable("cozinhaId") Long id // definindo o nome do PathVariable igual ao do placeholder
	  - @PathVariable Long cozinhaId       // definindo o parâmetro com o mesmo nome do placeholder
	
  - 4.15. [Customizando as representações XML e JSON com @JsonIgnore, @JsonProperty e @JsonRootName](https://github.com/marciafc/curso-especialista-spring-rest/tree/master/04.15-customizando-as-representacoes-xml-e-json-com-jsonignore-jsonproperty-e-jsonrootname/algafood-api)
  
    - Classe Cozinha
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
  
    